!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("bdt105angulardatabaseservice"),require("bdt105angularconnexionservice"),require("bdt105toolbox/dist")):"function"==typeof define&&define.amd?define(["exports","@angular/core","bdt105angulardatabaseservice","bdt105angularconnexionservice","bdt105toolbox/dist"],e):e((t.ng=t.ng||{},t.ng.bdt105angulartranslateservice={}),t.ng.core,t.bdt105angulardatabaseservice,t.bdt105angularconnexionservice,t.dist)}(this,function(t,e,n,a,r){"use strict";var o=function(){function t(t,e){if(this.databaseService=t,this.connexionService=e,this.configuration={translateTags:!0},this.toolbox=new r.Toolbox,this.translation=this.toolbox.readFromStorage("translation"),!this.translation){var n=function(){};this.loadFromDatabase(n,n)}}return t.prototype.setDatabaseBaseUrl=function(t){this.databaseService.configuration.baseUrl=t},t.prototype.translate=function(t){if(this.translation)for(var e=0;e<this.translation.length;e++)if(this.translation[e].name==t)return this.translation[e].label;return t},t.prototype.t=function(t){return this.translate(t)},t.prototype.loadFromDatabase=function(t,e){var n=this,a=this.connexionService.getConnexion();if(a){this.databaseService.connect(a.currentUser.login,a.currentUser.password);var r="SELECT * FROM label where user = 'everyone' and domain = 'rest' and lang = '"+a.currentUser.lang+"'";this.databaseService.sql(function(e){return n.success(t,e)},function(t){return n.failure(e,t)},r)}},t.prototype.success=function(t,e){this.translation=e.json.results,this.toolbox.writeToStorage("translation",this.translation,!1),t&&t(e)},t.prototype.failure=function(t,e){t&&t(e)},t.prototype.getTranslateTag=function(){var t=this.toolbox.readFromStorage("setting"),e=this.configuration.translateTags;return t&&t.translateTags&&(e=t.translateTags),e},t.prototype.refresh=function(t,e){this.loadFromDatabase(t,e)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:n.DatabaseService},{type:a.ConnexionService}]},t}();t.TranslateService=o,Object.defineProperty(t,"__esModule",{value:!0})});