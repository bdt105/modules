!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@angular/core"),require("@angular/http"),require("bdt105toolbox/dist")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/http","bdt105toolbox/dist"],o):o((t.ng=t.ng||{},t.ng.bdt105angulardatabaseservice={}),t.ng.core,t.http,t.dist)}(this,function(t,o,e,n){"use strict";var i=function(){function t(t){this.http=t,this.contentType="application/json",this.toolbox=new n.Toolbox,this.configuration={baseUrl:"http://editeur.vidal.fr/demo/apidb/demonstrationEditeur",baseUrlOld:"http://localhost/apidb/demonstrationLocalhost",sql:"/sql",update:"/update",read:"/read",fresh:"/fresh",structure:"/structure",insert:"/insert",save:"/save",delete:"/delete",fields:"/fields",count:"/count"}}return t.prototype.setHeaders=function(){var t="Basic "+btoa(this.login+":"+this.password),o=new e.Headers;return o.append("Authorization",t),o.append("Content-Type","application/json"),o},t.prototype.manageData=function(t,o){this.toolbox.log(o),o._body&&"string"==typeof o._body&&(o._body.startsWith("<?xml version")?o.json=this.toolbox.xml2json(o._body):o.json=this.toolbox.parseJson(o._body)),t(o)},t.prototype.manageError=function(t,o){console.log(o),t(o)},t.prototype.callPost=function(t,o,e,n){var i=this,r=this.setHeaders();this.toolbox.log(e),this.toolbox.log(n),this.toolbox.log(JSON.stringify(n)),this.http.post(e,n,{headers:r}).subscribe(function(o){return i.manageData(t,o)},function(t){return i.manageError(o,t)})},t.prototype.callGet=function(t,o,e){var n=this,i=this.setHeaders();this.toolbox.log(e),this.http.get(e,{headers:i}).subscribe(function(o){return n.manageData(t,o)},function(t){return n.manageError(o,t)})},t.prototype.calll=function(t,o,e,n,i){if(n){var r=this.configuration.baseUrl+e+"/"+n;this.callPost(t,o,r,i)}},t.prototype.connect=function(t,o){this.login=t,this.password=o},t.prototype.sql=function(t,o,e,n){void 0===n&&(n="5000");var i=this.configuration.baseUrl+this.configuration.sql,r={__sql:e,__limit:n};this.callPost(t,o,i,r)},t.prototype.read=function(t,o,e,n){this.calll(t,o,this.configuration.read,e,n)},t.prototype.insert=function(t,o,e,n){this.calll(t,o,this.configuration.insert,e,n)},t.prototype.delete=function(t,o,e,n){this.calll(t,o,this.configuration.delete,e,n)},t.prototype.save=function(t,o,e,n){this.calll(t,o,this.configuration.save,e,n)},t.prototype.fields=function(t,o,e){this.calll(t,o,this.configuration.fields,e)},t.prototype.successNeww=function(t,o){for(var e=t.json.results,n={},i=0;i<e.length;i++)n[e[i].Field]="";o&&o(n)},t.prototype.failureNeww=function(t,o){o&&o(t)},t.prototype.neww=function(t,o,e){var n=this;this.fields(function(o){return n.successNeww(o,t)},function(t){return n.failureNeww(t,o)},e)},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[{type:e.Http}]},t}();t.DatabaseService=i,Object.defineProperty(t,"__esModule",{value:!0})});