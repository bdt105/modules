{"version":3,"file":"vidal.service.js","sourceRoot":"","sources":["../../src/vidal.service.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;;AAE3C,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;;IAwD/C;KACC;IAEO,iCAAU,GAAlB,UAAoB,WAAwB;QAAxB,4BAAA,EAAA,wBAAwB;QACxC,IAAI,OAAO,GAAG,IAAI,OAAO,EAAE,CAAC;QAC5B,OAAO,CAAC,MAAM,CAAC,cAAc,EAAE,WAAW,CAAC,CAAC;QAC5C,OAAO,CAAC,MAAM,CAAC,6BAA6B,EAAE,GAAG,CAAC,CAAC;QACnD,MAAM,CAAC,OAAO,CAAC;KAClB;IAED,8BAAO,GAAP,UAAS,EAAO,EAAE,IAAY;QAC1B,IAAI,GAAG,GAAG,EAAE,GAAI,EAAE,CAAC;QACnB,EAAE,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAA,CAAC;YACnB,GAAG,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;SACpB;QACD,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,EAAE,GAAG,GAAG,EAAE,EAAE,CAAC,CAAC;KACjE;IAAA,CAAC;IAEF,oBAAoB;IACpB,6BAA6B;IAC7B,yBAAyB;IACzB,mDAAmD;IACnD,IAAI;IAEJ,+EAA+E;IAC/E,sCAAsC;IACtC,sCAAsC;IACtC,4DAA4D;IAC5D,8DAA8D;IAC9D,SAAS;IACT,IAAI;IAEJ,oHAAoH;IACpH,iDAAiD;IACjD,8DAA8D;IAC9D,4DAA4D;IAC5D,8DAA8D;IAC9D,SAAS;IACT,IAAI;;;;;;;;;;;;;;;;;;;;IAEI,+BAAQ;;;;;;;;;;;;;;;;;;;;IAAhB,UAAkB,QAAa,EAAE,IAAS,EAAE,KAAU;QAClD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,OAAO,IAAI,CAAC,KAAK,IAAK,QAAQ,CAAC,CAAC,CAAA,CAAC;YAChD,EAAE,CAAC,CAAU,IAAI,CAAC,KAAM,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAA,CAAC;gBAClD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACjD;YAAA,IAAI,CAAA,CAAC;gBACF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAClD;SACJ;QACD,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAA,CAAC;YACV,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;SACzB;KACJ;IAAA,CAAC;IAEF,oCAAa,GAAb;QACI,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;QACtD,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;QACrC,EAAE,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,YAAY,CAAC,CAAA,CAAC;YACjC,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC;SAC9B;QACD,MAAM,CAAC,GAAG,CAAC;KACd;IAAA,CAAC;IAEF,mCAAY,GAAZ;QACI,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;QACtD,IAAI,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;QAC/C,EAAE,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,cAAc,CAAC,CAAA,CAAC;YACnC,SAAS,GAAG,OAAO,CAAC,cAAc,CAAC;SACtC;QACD,MAAM,CAAC,SAAS,CAAC;KACpB;IAAA,CAAC;IAEF,iCAAU,GAAV;QACI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;KACrC;IAAA,CAAC;IAEF,gCAAS,GAAT;QACI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;KACpC;IAAA,CAAC;IAEF,wCAAiB,GAAjB,UAAkB,MAAc;QAC5B,MAAM,CAAC,MAAM,GAAG,SAAS,GAAG,IAAI,CAAC,SAAS,EAAE,GAAG,WAAW,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;KAClF;IAED,6BAAM,GAAN,UAAO,QAAkB,EAAE,MAAc;QACrC,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC7B,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,GAAG,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACzI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,sCAAe,GAAf,UAAgB,QAAkB,EAAE,MAAc;QAC9C,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC7B,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,eAAe,GAAG,KAAK,GAAG,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAClJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,kCAAW,GAAX,UAAY,MAAc,EAAE,MAAc;QAA1C,iBAKC;QAJG,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC7B,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,GAAG,MAAM,GAAG,UAAU,GAAG,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAC/J,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAED,mCAAY,GAAZ,UAAa,MAAc;QAA3B,iBAKC;QAJG,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC7B,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,eAAe,GAAG,KAAK,GAAG,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAClJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAED,qCAAc,GAAd,UAAe,MAAc;QAA7B,iBAKC;QAJG,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC7B,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,GAAG,KAAK,GAAG,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACpJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAED,wCAAiB,GAAjB,UAAkB,eAAyB,EAAE,eAAyB,EAAE,MAAc;QAAtF,iBAKC;QAJG,EAAE,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC7B,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,GAAG,KAAK,GAAG,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACpJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAED,gCAAS,GAAT,UAAW,eAAyB,EAAE,eAAyB,EAAE,IAAY,EAAE,EAAU;QAAzF,iBAKC;QAJG,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACpH,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAAA,CAAC;IAEF,2CAAoB,GAApB,UAAsB,eAAyB,EAAE,eAAyB,EAAE,IAAY,EAAE,EAAU;QAApG,iBAKC;QAJG,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAC/H,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAAA,CAAC;IAEF,4CAAqB,GAArB,UAAuB,eAAyB,EAAE,eAAyB,EAAE,IAAY,EAAE,EAAU;QAArG,iBAKC;QAJG,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAChI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAAA,CAAC;IAEF,qCAAc,GAAd,UAAgB,eAAyB,EAAE,eAAyB,EAAE,IAAY,EAAE,EAAU;QAA9F,iBAKC;QAJG,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACrI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAhC,CAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACnH;KACJ;IAAA,CAAC;IAEM,6CAAsB,GAA9B,UAA+B,gBAAqB;QAChD,IAAI,GAAG,GAAG,qBAAqB,CAAC;QAChC,GAAG,IAAI,gBAAgB,GAAG,gBAAgB,CAAC,WAAW,GAAG,GAAG,GAAG,gBAAgB,CAAC,SAAS,GAAG,SAAS,CAAC;;;QAGtG,GAAG,IAAI,QAAQ,GAAG,gBAAgB,CAAC,IAAI,GAAG,SAAS,CAAC;QACpD,GAAG,IAAI,UAAU,GAAG,gBAAgB,CAAC,MAAM,GAAG,WAAW,CAAC;QAC1D,GAAG,IAAI,YAAY,GAAG,gBAAgB,CAAC,QAAQ,GAAG,aAAa,CAAC;QAChE,GAAG,IAAI,gBAAgB,GAAG,gBAAgB,CAAC,YAAY,GAAG,iBAAiB,CAAC;QAC5E,GAAG,IAAI,iBAAiB,GAAG,gBAAgB,CAAC,aAAa,GAAG,kBAAkB,CAAC;QAC/E,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC,+BAA+B,GAAG,gBAAgB,CAAC,OAAO,GAAG,mBAAmB,CAAA,CAAC,CAAC,EAAE,CAAC,CAAC;QACzH,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,IAAI,gBAAgB,CAAC,YAAY,IAAI,EAAE,CAAC,CAAC,CAAC,8CAA8C,GAAG,gBAAgB,CAAC,YAAY,GAAG,6BAA6B,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QACpM,MAAM,CAAC,GAAG,GAAG,sBAAsB,CAAC;KACvC;IAEO,yCAAkB,GAA1B,UAA2B,OAAY;QACnC,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,EAAE,CAAC,CAAC,OAAO,CAAC,CAAA,CAAC;YACT,GAAG,IAAI,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,eAAe,GAAG,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YAC/G,GAAG,IAAI,UAAU,GAAG,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC;YACjD,GAAG,IAAI,UAAU,GAAG,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC;YACjD,GAAG,IAAI,UAAU,GAAG,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC;YACjD,GAAG,IAAI,OAAO,CAAC,aAAa,IAAI,OAAO,CAAC,aAAa,IAAI,EAAE,IAAI,OAAO,CAAC,aAAa,IAAI,IAAI,CAAC,CAAC,CAAC,iBAAiB,GAAG,OAAO,CAAC,aAAa,GAAG,kBAAkB,CAAC,CAAC,CAAC,EAAE,CAAC;YACnK,GAAG,IAAI,OAAO,CAAC,iBAAiB,IAAI,OAAO,CAAC,iBAAiB,IAAI,EAAE,IAAI,OAAO,CAAC,iBAAiB,IAAI,IAAI,CAAC,CAAC,CAAC,qBAAqB,GAAG,OAAO,CAAC,iBAAiB,GAAG,sBAAsB,CAAC,CAAC,CAAC,EAAE,CAAC;YAC3L,GAAG,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,OAAO,IAAI,EAAE,IAAI,OAAO,CAAC,OAAO,IAAI,IAAI,IAAI,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,CAAC,CAAC,WAAW,GAAG,OAAO,CAAC,OAAO,GAAG,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC;YAC1J,GAAG,IAAI,OAAO,CAAC,oBAAoB,IAAI,OAAO,CAAC,oBAAoB,IAAI,EAAE,CAAC,CAAC,CAAC,wBAAwB,GAAG,OAAO,CAAC,oBAAoB,GAAG,yBAAyB,CAAC,CAAC,CAAC,EAAE,CAAC;SACxK;QACD,MAAM,CAAC,GAAG,CAAC;KACd;IAEO,oCAAa,GAArB,UAAsB,OAAY;QAC9B,EAAE,CAAC,CAAC,OAAO,CAAC,CAAA,CAAC;YACT,IAAI,GAAG,GAAG,WAAW,CAAC;YACtB,IAAI,GAAG,GAAG,EAAE,CAAC;YAEb,GAAG,IAAI,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;YAExC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;gBACrD,IAAI,GAAG,GAAG,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACxC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;oBAC/B,GAAG,IAAI,aAAa,CAAC;oBACrB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAG,CAAC,EAAE,EAAC,CAAC;wBAClC,GAAG,IAAI,2BAA2B,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC;qBAC9D;oBACD,GAAG,IAAI,cAAc,CAAC;iBACzB;aACJ;YAED,EAAE,CAAC,CAAC,OAAO,CAAC,WAAW,IAAI,OAAO,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;gBACvD,IAAI,GAAG,GAAG,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACzC,EAAE,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;oBAChC,GAAG,IAAI,aAAa,CAAC;oBACrB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAG,CAAC,EAAE,EAAC,CAAC;wBAClC,GAAG,IAAI,6BAA6B,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,aAAa,CAAC;qBACjE;oBACD,GAAG,IAAI,cAAc,CAAC;iBACzB;aACJ;YAED,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;gBACjD,IAAI,GAAG,GAAG,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACtC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;oBAC7B,GAAG,IAAI,eAAe,CAAC;oBACvB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAG,CAAC,EAAE,EAAC,CAAC;wBAClC,GAAG,IAAI,2BAA2B,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC;qBAChE;oBACD,GAAG,IAAI,gBAAgB,CAAC;iBAC3B;aACJ;YAGD,MAAM,CAAC,GAAG,GAAG,YAAY,CAAC;SAC7B;QACD,MAAM,CAAC,EAAE,CAAC;KACb;IAEO,yCAAkB,GAA1B,UAA2B,YAAiB;QACxC,EAAE,CAAC,CAAC,YAAY,CAAC,CAAA,CAAC;YACd,IAAI,GAAG,GAAG,uEAAuE,CAAC;YAClF,IAAI,QAAQ,GAAG,sBAAsB,CAAC;YACtC,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAA,CAAC;gBACpB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAG,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;oBAC/C,QAAQ,IAAI,IAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;iBAClE;aACJ;YACD,QAAQ,IAAI,uBAAuB,CAAA;YACnC,IAAI,UAAU,GAAG,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YACtF,MAAM,CAAC,GAAG,GAAG,UAAU,GAAG,QAAQ,GAAG,iBAAiB,CAAC;SAC1D;QACD,MAAM,CAAC,EAAE,CAAC;KACb;IAED,gCAAS,GAAT,UAAU,QAAkB,EAAE,YAAiB,EAAE,MAAW,EAAE,IAAY;QACtE,EAAE,CAAC,CAAC,YAAY,IAAI,YAAY,CAAC,KAAK,IAAI,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YACrE,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;YACpD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC9B,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS;gBAC5D,CAAC,IAAI,IAAI,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACnH,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAA3B,CAA2B,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SAC7H;KACJ;IAEO,oCAAa,GAArB,UAAsB,QAAgB;QAClC,IAAI,KAAK,GAAG,EAAC,YAAY,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,EAAC,CAAC;QAC9C,MAAM,CAAA,CAAC,QAAQ,CAAC,CAAA,CAAC;YACb,KAAK,SAAS;gBACV,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;gBAC5B,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;gBACzB,KAAK,CAAC;YACN,KAAK,SAAS;gBACV,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;gBAC5B,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;gBACzB,KAAK,CAAC;YACN,KAAK,SAAS;gBACV,KAAK,CAAC,UAAU,GAAG,SAAS,CAAC;gBAC7B,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;gBACzB,KAAK,CAAC;YACN,KAAK,SAAS;gBACV,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC;gBACzB,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;gBACzB,KAAK,CAAC;YACN,KAAK,MAAM;gBACP,KAAK,CAAC,UAAU,GAAG,SAAS,CAAC;gBAC7B,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;gBACzB,KAAK,CAAC;YACN;gBACA,KAAK,CAAC;SACT;QACD,MAAM,CAAC,KAAK,CAAC;KAEhB;IAEO,wCAAiB,GAAzB,UAA0B,KAAU;QAChC,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,EAAE,CAAC,CAAC,KAAK,CAAC,CAAA,CAAC;YACP,EAAE,CAAC,CAAC,KAAK,CAAC,0BAA0B,CAAC,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBACrG,KAAK,CAAC,0BAA0B,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBAC9C,KAAK,CAAC,0BAA0B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC/G,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC,CAAC;aAC/C;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,mCAAmC,CAAC,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBACvH,KAAK,CAAC,mCAAmC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBACvD,KAAK,CAAC,mCAAmC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,mCAAmC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBACjI,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;aAC/C;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,uCAAuC,CAAC,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBAC/H,KAAK,CAAC,uCAAuC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBAC3D,KAAK,CAAC,uCAAuC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,uCAAuC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBACzI,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,uCAAuC,CAAC,CAAC,CAAC;aAC5D;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,kCAAkC,CAAC,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBACrH,KAAK,CAAC,kCAAkC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBACtD,KAAK,CAAC,kCAAkC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,kCAAkC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC/H,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,kCAAkC,CAAC,CAAC,CAAC;aACvD;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,2BAA2B,CAAC,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBACvG,KAAK,CAAC,2BAA2B,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBAC/C,KAAK,CAAC,2BAA2B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBACjH,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC,CAAC;aAChD;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,6BAA6B,CAAC,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBAC3G,KAAK,CAAC,6BAA6B,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBACjD,KAAK,CAAC,6BAA6B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBACrH,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC,CAAC;aAClD;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,8BAA8B,CAAC,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBAC7G,KAAK,CAAC,8BAA8B,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBAClD,KAAK,CAAC,8BAA8B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBACvH,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC,CAAC;aACnD;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,wCAAwC,CAAC,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAA,CAAC;gBACjI,KAAK,CAAC,wCAAwC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC;gBAC5D,KAAK,CAAC,wCAAwC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,wCAAwC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC3I,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,wCAAwC,CAAC,CAAC,CAAC;aAC7D;SACJ;QACD,MAAM,CAAC,GAAG,CAAC;KACd;IAED,0CAAmB,GAAnB,UAAoB,YAAiB,EAAE,SAAc;QACjD,EAAE,CAAC,CAAC,YAAY,IAAI,SAAS,IAAI,SAAS,CAAC,IAAI,IAAI,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA,CAAC;YACrE,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBAChD,IAAI,IAAI,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACjC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;gBACvB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;oBAClD,IAAI,KAAK,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACpC,EAAE,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,2BAA2B,CAAC,CAAC,CAAA,CAAC;wBACrD,EAAE,CAAC,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAA,CAAC;4BAC5C,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;yBACrD;qBACJ;iBACJ;aACJ;SACJ;KACJ;IAED,qCAAc,GAAd,UAAgB,IAAY,EAAE,WAAoB,EAAE,UAAmB;QACnE,EAAE,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC,CAAA,CAAC;YAC7B,IAAI,KAAK,GAAG,SAAS,CAAC;YACtB,KAAK,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC;YAClD,EAAE,CAAC,CAAC,WAAW,CAAC,CAAA,CAAC;gBACb,KAAK,IAAI,IAAI,CAAC,aAAa,CAAC,0BAA0B,CAAC;aAC1D;YACD,EAAE,CAAC,CAAC,UAAU,CAAC,CAAA,CAAC;gBACZ,KAAK,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,yBAAyB,CAAC;aAC/D;YACD,KAAK,IAAI,UAAU,CAAC;YACpB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,qBAAqB,EAAE,KAAK,CAAC,CAAC;SACrD;QACD,MAAM,CAAC,IAAI,CAAC;KACf;IAAA,CAAC;IAEF,qCAAc,GAAd,UAAe,QAAkB,EAAE,IAAY,EAAE,EAAU;QACvD,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACvI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,mCAAY,GAAZ,UAAa,QAAkB,EAAE,IAAY,EAAE,EAAU,EAAE,MAAW;QAClE,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACtI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,MAAM,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SAC/G;KACJ;IAED,6CAAsB,GAAtB,UAAuB,QAAkB,EAAE,IAAY,EAAE,EAAU;QAC/D,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,qBAAqB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAC5I,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,+CAAwB,GAAxB,UAAyB,QAAkB,EAAE,IAAY,EAAE,EAAU;QACjE,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,uBAAuB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAC9I,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,iCAAU,GAAV,UAAW,QAAkB,EAAE,IAAY,EAAE,EAAU;QACnD,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAA,CAAC;YACZ,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACpH,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,qCAAc,GAAd,UAAe,QAAkB,EAAE,YAAiB;QAChD,EAAE,CAAC,CAAC,YAAY,IAAI,YAAY,CAAC,OAAO,CAAC,CAAA,CAAC;YACtC,IAAI,GAAG,GAAG,YAAY,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACtD,IAAI,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC;YACvB,IAAI,QAAQ,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAC5C,IAAI,MAAM,GAAG,EAAE,CAAC;YAChB,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,IAAI,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;gBACrD,IAAI,IAAI,GAAG,EAAE,CAAC;gBACd,IAAI,MAAM,GAAG,EAAE,CAAC;gBAChB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;oBAChD,IAAI,KAAK,GAAG,EAAC,MAAM,EAAE,IAAI,KAAK,EAAE,EAAE,cAAc,EAAE,IAAI,KAAK,EAAE,EAAE,cAAc,EAAE,IAAI,KAAK,EAAE,EAAE,aAAa,EAAE,IAAI,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,KAAK,EAAE,EAAC,CAAC;oBAC/I,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAA,CAAC;wBAChC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;qBACnD;oBACD,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAA,CAAC;wBAClC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;qBAC7D;oBACD,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAA,CAAC;wBACrC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC;qBAChE;oBACD,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAA,CAAC;wBAC/B,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;qBACpD;oBACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;iBACtB;aACJ;YACD,IAAI,IAAI,GAAG,EAAC,KAAK,EAAE,QAAQ,EAAE,eAAe,EAAE,MAAM,EAAC,CAAC;YACtD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;YACvC,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;YACtC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,kBAAkB,CAAC,CAAC;SAC3H;KACJ;IAED,yCAAkB,GAAlB,UAAmB,QAAkB,EAAE,IAAY,EAAE,EAAU;QAC3D,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,SAAS,IAAI,IAAI,IAAI,SAAS,CAAC,CAAC,CAAA,CAAC;YACxD,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACrH,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAEO,qCAAc,GAAtB,UAAuB,OAAY,EAAE,QAAkB,EAAE,aAAuB;QAC5E,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,WAAW,GAAG,EAAE,CAAC;QAErB,IAAI,UAAU,GAAG,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,GAAG,YAAY,CAAC;QAE/E,EAAE,CAAC,CAAC,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YACjC,MAAM,GAAG,UAAU,CAAC;YACpB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBACtC,MAAM,IAAI,uBAAuB,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC;aAChE;YACD,MAAM,IAAI,WAAW,CAAA;SACxB;QAED,EAAE,CAAC,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC3C,WAAW,GAAG,eAAe,CAAC;YAC9B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBAC3C,WAAW,IAAI,iCAAiC,GAAG,aAAa,CAAC,CAAC,CAAC,GAAG,eAAe,CAAC;aACzF;YACD,WAAW,IAAI,gBAAgB,CAAA;SAClC;QAED,MAAM,CAAC,2EAA2E,GAAG,UAAU,GAAG,MAAM,GAAG,WAAW,GAAG,qBAAqB,CAAC;KAClJ;IAED,6CAAsB,GAAtB,UAAuB,QAAkB,EAAE,IAAY,EAAE,EAAU,EAAE,OAAY,EAAE,QAAkB,EAAE,aAAuB,EAAE,MAAW;QACvI,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,IAAI,OAAO,CAAC,CAAA,CAAC;YACvB,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,uBAAuB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACjJ,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,QAAQ,EAAE,aAAa,CAAC,CAAC;YACpE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACvH;KACJ;IAED,6CAAsB,GAAtB,UAAuB,eAAuB;QAC1C,IAAI,GAAG,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,GAAG,IAAI,eAAe,EAA1B,CAA0B,CAAC,CAAC;QAC7E,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;KACvB;IAED,6CAAsB,GAAtB,UAAuB,MAAc;QACjC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAA,CAAC;YACR,IAAI,GAAG,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,KAAK,IAAI,MAAM,EAAnB,CAAmB,CAAC,CAAC;YACtE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;SACrB;QAAA,IAAI,CAAA,CAAC;YACF,MAAM,CAAC,EAAE,CAAC;SACb;KACJ;IAEO,2CAAoB,GAA5B,UAA6B,KAAe,EAAE,UAAoB,EAAE,IAAY;QAC5E,IAAI,GAAG,GAAG,iDAAiD,CAAC;QAC5D,EAAE,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YAC3B,GAAG,IAAI,SAAS,CAAC;YACjB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAE,CAAC,EAAE,CAAC,GAAE,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBACjC,GAAG,IAAI,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC;aACtC;YACD,GAAG,IAAI,UAAU,CAAC;SACrB;QACD,EAAE,CAAC,CAAC,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YACrC,GAAG,IAAI,kBAAkB,CAAC;YAC1B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAE,CAAC,EAAE,CAAC,GAAE,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBACtC,GAAG,IAAI,iBAAiB,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC;aACjE;YACD,GAAG,IAAI,mBAAmB,CAAC;SAC9B;QACD,EAAE,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA,CAAC;YACzB,GAAG,IAAI,QAAQ,GAAG,IAAI,GAAG,SAAS,CAAC;SACtC;QACD,GAAG,IAAI,kEAAkE,CAAC;QAC1E,MAAM,CAAC,GAAG,CAAC;KACd;IAED,wCAAiB,GAAjB,UAAkB,QAAkB,EAAE,KAAe,EAAE,UAAoB,EAAE,IAAY,EAAE,MAAW;QAClG,EAAE,CAAC,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA,CAAC;YAC1D,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACpI,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;YACjE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACvH;KACJ;IAED,oDAA6B,GAA7B,UAA8B,QAAkB,EAAE,EAAU;QACvD,EAAE,CAAC,CAAC,EAAE,CAAC,CAAA,CAAC;YACL,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,eAAe,GAAG,GAAG,GAAG,EAAE,GAAG,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACxJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,oDAA6B,GAA7B,UAA8B,QAAkB,EAAE,EAAU;QACvD,EAAE,CAAC,CAAC,EAAE,CAAC,CAAA,CAAC;YACL,IAAI,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,eAAe,GAAG,GAAG,GAAG,EAAE,GAAG,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACvJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACxG;KACJ;IAED,2CAAoB,GAApB,UAAqB,QAAkB,EAAE,YAAiB,EAAE,MAAW;QACnE,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;QACpD,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;QACtI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QACvC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;KACvH;IAED,iCAAU,GAAV,UAAW,EAAU;QACjB,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;KAC3I;IAED,8BAAO,GAAP,UAAQ,QAAkB,EAAE,EAAU;QAClC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;KACxH;IAEO,wCAAiB,GAAzB,UAA0B,KAAa,EAAE,MAAa,EAAE,IAAY,EAAE,QAAgB;QAClF,IAAI,GAAG,GAAG,iBAAiB,CAAC;QAC5B,GAAG,IAAI,UAAU,GAAG,KAAK,GAAG,WAAW,CAAC;QACxC,GAAG,IAAI,8CAA8C,CAAC;QACtD,GAAG,IAAI,UAAU,CAAC;QAClB,EAAE,CAAC,CAAC,MAAM,CAAC,CAAA,CAAC;YACR,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBAClC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAA,CAAC;oBAClB,GAAG,IAAI,gBAAgB,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,aAAa,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;iBACjI;aACJ;SACJ;QACD,GAAG,IAAI,WAAW,CAAC;QACnB,GAAG,IAAI,cAAc,GAAG,IAAI,GAAG,eAAe,CAAC;QAC/C,GAAG,IAAI,aAAa,GAAG,QAAQ,GAAG,cAAc,CAAC;QACjD,GAAG,IAAI,kBAAkB,CAAC;QAC1B,MAAM,CAAC,GAAG,CAAC;KACd;IAED,sCAAe,GAAf,UAAgB,QAAkB,EAAE,KAAa,EAAE,MAAa,EAAE,IAAY,EAAE,QAAgB,EAAE,MAAW;QACzG,EAAE,CAAC,CAAC,KAAK,CAAC,CAAA,CAAC;YACP,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;YACpE,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACjI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACvH;KACJ;IAGO,wCAAiB,GAAzB,UAA0B,KAAe,EAAE,YAAoB;QAC3D,IAAI,GAAG,GAAG,wEAAwE,CAAC;QACnF,GAAG,IAAI,WAAW,CAAC;QACnB,GAAG,IAAI,OAAO,CAAC;QACf,EAAE,CAAC,CAAC,KAAK,CAAC,CAAA,CAAC;YACP,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBAC7B,GAAG,IAAI,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC;aAC1C;SACJ;QACD,GAAG,IAAI,QAAQ,CAAC;QAChB,GAAG,IAAI,gBAAgB,GAAG,YAAY,GAAG,iBAAiB,CAAC;QAC3D,GAAG,IAAI,YAAY,CAAC;QACpB,MAAM,CAAC,GAAG,CAAC;KACd;IAED,qCAAc,GAAd,UAAe,QAAkB,EAAE,KAAe,EAAE,YAAoB,EAAE,MAAW;QACjF,EAAE,CAAC,CAAC,YAAY,CAAC,CAAA,CAAC;YACd,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;YAC1D,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACnI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACvH;KACJ;IAED,mCAAY,GAAZ,UAAa,IAAS,EAAE,KAAa;QACjC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA,CAAC;YACrD,IAAI,IAAI,GAAG,EAAE,CAAC;YACd,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC,CAAC;gBAClD,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;;gBAEpC,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC;aACzB;YACD,MAAM,CAAC,qCAAqC,GAAG,KAAK,GAAG,OAAO,GAAG,IAAI,GAAG,QAAQ,CAAC;SACpF;KACJ;IAED,iCAAU,GAAV,UAAW,QAAkB,EAAE,MAAW,EAAE,WAAuB;QAAvB,4BAAA,EAAA,kBAAuB;QAC/D,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,GAAG,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,CAAC;QAChK,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,IAAS,EAAE,KAAU,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,EAArB,CAAqB,EAAE,KAAK,EAAE,MAAM,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;KAC/G;IAED,oCAAa,GAAb,UAAc,MAAW;QACrB,EAAE,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,CAAA,CAAC;YAClB,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,IAAI,CAAC,CAAC,CAAA,CAAC;gBACpB,EAAE,CAAC,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAA,CAAC;oBAC9B,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;iBACpB;gBAAA,IAAI,CAAA,CAAC;oBACF,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAA,CAAC;wBAChB,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;qBACzB;iBACJ;aACJ;SACJ;QACD,EAAE,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAA,CAAC;YACzB,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SACtB;QACD,MAAM,CAAC,MAAM,CAAC;KACjB;uBAnrBL","sourcesContent":["import { Injectable } from '@angular/core';\r\n//import { Http, RequestOptions, RequestMethod, Headers } from '@angular/http';\r\nimport { Toolbox, Rest } from 'bdt105toolbox/dist';\r\n\r\n@Injectable()\r\nexport class VidalService {\r\n\r\n    public body: any;\r\n    \r\n    private toolbox: Toolbox = new Toolbox();\r\n    private rest: Rest = new Rest();\r\n\r\n    private contentType = \"text/xml\";\r\n\r\n    public configuration = {\r\n        \"baseUrl\": \"http://api.vidal.fr\",\r\n        \"urlVigie\": \"http://dev-vidal-memo.vidal.fr/api/memo-rules/rules\",\r\n        \"apiDomain0\": \"/excalibur-service/api\",\r\n        \"apiDomain\": \"/rest/api\",\r\n        \"newsDomain\": \"/rest/news\",\r\n        \"pmsiDomain\": \"/rest/pmsi\",\r\n        \"cim10\": \"/cim10\",\r\n        \"allergies\": \"/allergies\",\r\n        \"pathologies\": \"/pathologies\",\r\n        \"search\": \"/search\",\r\n        \"searchAllergies\": \"/allergies\",\r\n        \"searchPathologies\": \"/pathologies\",\r\n        \"alerts\": \"/alerts\",\r\n        \"alertsFull\": \"/alerts/full\",\r\n        \"alertsHtml\": \"/alerts/html\",\r\n        \"reco\": \"/reco\",\r\n        \"version\": \"/version\",\r\n        \"postComplement\": \"/postComplement\",\r\n        \"indicationGroup\": \"/indication-group\",\r\n        \"prescriptionRecos\": \"/recos/guidelines\",\r\n        \"adaptedDrugs\": \"/adapted-drugs\",\r\n        \"sideEffectSort\": \"/side-effect/sort-drugs\",\r\n        \"app_id\": \"\",\r\n        \"app_key\": \"\",\r\n        \"alertsStyle\": false,\r\n        \"alertsHtmlStyle\": \"#main{max-width: 100%} .jquery_tabs ul.tabs-list{width: 20%} .jquery_tabs .content {width: 79%; border: 0px} #main, #sommaire_summary, .grid, .jquery_tabs .content, td {background: transparent}\",\r\n        \"alertsHtmlStyleHideSidebar\": \"\",\r\n        \"alertsHtmlStyleHideHeader\": \"body {margin-top: 10px}\",\r\n    };\r\n    \r\n    private frequencyToUnitId = [\r\n        {\"key\": \"PER_24_HOURS\", \"value\": 718},\r\n        {\"key\": \"PER_DAY\", \"value\": 717},\r\n        {\"key\": \"PER_HOUR\", \"value\": 716},\r\n        {\"key\": \"PER_MINUTE\", \"value\": 715},\r\n        {\"key\": \"PER_MONTH\", \"value\": 721},\r\n        {\"key\": \"PER_WEEK\", \"value\": 720},\r\n        {\"key\": \"PER_YEAR\", \"value\": 722},\r\n        {\"key\": \"THIS_DAY\", \"value\": 714},\r\n        {\"key\": \"TYPE_44\", \"value\": 725},\r\n        {\"key\": \"TYPE_66\", \"value\": 724}\r\n    ]\r\n\r\n    constructor() {\r\n    }\r\n\r\n    private setHeaders (contentType = \"text/xml\"): Headers{\r\n        var headers = new Headers();\r\n        headers.append(\"Content-Type\", contentType);\r\n        headers.append(\"Access-Control-Allow-Origin\", \"*\");\r\n        return headers;\r\n    }\r\n\r\n    cleanId (id: any, type: string){\r\n        var idd = id  + \"\";\r\n        if (Array.isArray(id)){\r\n            idd = id[0] + \"\";\r\n        }\r\n        return idd.replace(\"vidal://\" + type.toLowerCase() + \"/\", \"\");\r\n    };\r\n\r\n    // get(url: string){\r\n    //     let rest = new Rest();\r\n    //     return rest.call()\r\n    //     return this.http.get(url, {headers: headrs})\r\n    // }\r\n\r\n    // callGet (callbackSuccess: Function, callbackFailure: Function, url: string){\r\n    //     var headrs = this.setHeaders();\r\n    //     return this.get(url).subscribe(\r\n    //         (data) => this.manageData(callbackSuccess, data),\r\n    //         (error) => this.manageError(callbackFailure, error)\r\n    //     );\r\n    // }\r\n\r\n    // callPost(callbackSuccess: Function, callbackFailure: Function, url: string, body: any, contentType = \"text/xml\"){\r\n    //     var headrs = this.setHeaders(contentType);\r\n    //     this.http.post(url, body, {headers: headrs}).subscribe(\r\n    //         (data) => this.manageData(callbackSuccess, data),\r\n    //         (error) => this.manageError(callbackFailure, error)\r\n    //     );\r\n    // }\r\n\r\n    private callback (callback: any, data: any, error: any){\r\n        if (data._body && (typeof data._body  == \"string\")){\r\n            if ((<string>data._body).startsWith(\"<?xml version\")){\r\n                data.json = this.toolbox.xml2json(data._body);\r\n            }else{\r\n                data.json = this.toolbox.parseJson(data._body);\r\n            }\r\n        }\r\n        if (callback){\r\n            callback(data, error);\r\n        }\r\n    };\r\n\r\n    getApiBaseUrl (){\r\n        var setting = this.toolbox.readFromStorage(\"setting\");\r\n        var url = this.configuration.baseUrl;\r\n        if (setting && setting.vidalBaseUrl){\r\n            url = setting.vidalBaseUrl;\r\n        }\r\n        return url;\r\n    }; \r\n\r\n    getHtmlStyle (){\r\n        var setting = this.toolbox.readFromStorage(\"setting\");\r\n        var htmlStyle = this.configuration.alertsStyle;\r\n        if (setting && setting.vidalHtmlStyle){\r\n            htmlStyle = setting.vidalHtmlStyle;\r\n        }\r\n        return htmlStyle;\r\n    }; \r\n\r\n    getApp_key (){\r\n        return this.configuration.app_key;\r\n    };    \r\n\r\n    getApp_id (){\r\n        return this.configuration.app_id;\r\n    };       \r\n\r\n    getUrlCredentials(prefix: string){\r\n        return prefix + \"app_id=\" + this.getApp_id() + \"&app_key=\" + this.getApp_key();\r\n    }\r\n\r\n    search(callback: Function, params: string){\r\n        if (params && params.length > 2){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.search + \"?q=\" + params + this.getUrlCredentials(\"&\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    searchAllergies(callback: Function, params: string){\r\n        if (params && params.length > 2){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.searchAllergies + \"?q=\" + params + this.getUrlCredentials(\"&\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getProducts(params: string, filter: string){\r\n        if (params && params.length > 2){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.search + \"?q=\" + params + \"&filter=\" + filter + this.getUrlCredentials(\"&\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getAllergies(params: string){\r\n        if (params && params.length > 2){        \r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.searchAllergies + \"?q=\" + params + this.getUrlCredentials(\"&\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getPathologies(params: string){\r\n        if (params && params.length > 2){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.searchPathologies + \"?q=\" + params + this.getUrlCredentials(\"&\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    searchPathologies(callbackSuccess: Function, callbackFailure: Function, params: string){\r\n        if (params && params.length > 2){        \r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.searchPathologies + \"?q=\" + params + this.getUrlCredentials(\"&\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getFromId (callbackSuccess: Function, callbackFailure: Function, type: string, id: string){\r\n        if (type && id){\r\n            let url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    };\r\n    \r\n    getPrescriptionUnits (callbackSuccess: Function, callbackFailure: Function, type: string, id: string){\r\n        if (type && id){\r\n            let url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/units\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    };\r\n    \r\n    getPrescriptionRoutes (callbackSuccess: Function, callbackFailure: Function, type: string, id: string){\r\n        if (type && id){\r\n            let url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/routes\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    };\r\n    \r\n    getIndications (callbackSuccess: Function, callbackFailure: Function, type: string, id: string){\r\n        if (type && id){\r\n            let url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/indications\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => this.callback(null, data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    };\r\n\r\n    private getPrescriptionLineXml(prescriptionLine: any){\r\n        var xml = \"<prescription-line>\";\r\n        xml += \"<drug>vidal://\" + prescriptionLine.productType + \"/\" + prescriptionLine.productId + \"</drug>\";\r\n        // xml += \"<drugId>\" + prescriptionLine.productId + \"</drugId>\";\r\n        // xml += \"<drugType>\" + (prescriptionLine.productType == \"package\" ? \"PACK\" : prescriptionLine.productType.toUpperCase()) + \"</drugType>\";\r\n        xml += \"<dose>\" + prescriptionLine.dose + \"</dose>\";\r\n        xml += \"<unitId>\" + prescriptionLine.unitId + \"</unitId>\";\r\n        xml += \"<duration>\" + prescriptionLine.duration + \"</duration>\";\r\n        xml += \"<durationType>\" + prescriptionLine.durationType + \"</durationType>\";\r\n        xml += \"<frequencyType>\" + prescriptionLine.frequencyType + \"</frequencyType>\";\r\n        xml += (prescriptionLine.routeId ? \"<routes><route>vidal://route/\" + prescriptionLine.routeId + \"</route></routes>\": \"\");\r\n        xml += (prescriptionLine.indicationId && prescriptionLine.indicationId != \"\" ? \"<indications><indication>vidal://indication/\" + prescriptionLine.indicationId + \"</indication></indications>\" : \"\");   \r\n        return xml + \"</prescription-line>\";        \r\n    }\r\n\r\n    private getBasicPatientXml(patient: any){\r\n        var xml = \"\";\r\n        if (patient){\r\n            xml += patient.dateOfBirth ? (\"<dateOfBirth>\" + patient.dateOfBirth.replace(\" \", \"T\") + \"</dateOfBirth>\") : \"\";\r\n            xml += \"<gender>\" + patient.gender + \"</gender>\";\r\n            xml += \"<weight>\" + patient.weight + \"</weight>\";\r\n            xml += \"<height>\" + patient.height + \"</height>\";\r\n            xml += patient.breastFeeding && patient.breastFeeding != \"\" && patient.breastFeeding != \"-1\" ? \"<breastFeeding>\" + patient.breastFeeding + \"</breastFeeding>\" : \"\";\r\n            xml += patient.weeksOfAmenorrhea && patient.weeksOfAmenorrhea != \"\" && patient.weeksOfAmenorrhea != \"-1\" ? \"<weeksOfAmenorrhea>\" + patient.weeksOfAmenorrhea + \"</weeksOfAmenorrhea>\" : \"\";\r\n            xml += patient.creatin && patient.creatin != \"\" && patient.creatin != null && patient.creatin != \"-1\" ? \"<creatin>\" + patient.creatin + \"</creatin>\" : \"\";\r\n            xml += patient.hepaticInsufficiency && patient.hepaticInsufficiency != \"\" ? \"<hepaticInsufficiency>\" + patient.hepaticInsufficiency + \"</hepaticInsufficiency>\" : \"\";\r\n        }\r\n        return xml;\r\n    }\r\n\r\n    private getPatientXml(patient: any){\r\n        if (patient){\r\n            var xml = \"<patient>\";\r\n            var arr = [];\r\n            \r\n            xml += this.getBasicPatientXml(patient);\r\n           \r\n            if (patient.allergyIds && patient.allergyIds.length > 0){\r\n                var all = patient.allergyIds.split(\"|\");\r\n                if (patient.allergyIds.length > 0){\r\n                    xml += \"<allergies>\";\r\n                    for (var i = 0; i < all.length ; i++){\r\n                        xml += \"<allergy>vidal://allergy/\" + all[i] + \"</allergy>\";\r\n                    }\r\n                    xml += \"</allergies>\";\r\n                }\r\n            }\r\n            \r\n            if (patient.moleculeIds && patient.moleculeIds.length > 0){\r\n                var all = patient.moleculeIds.split(\"|\");\r\n                if (patient.moleculeIds.length > 0){\r\n                    xml += \"<molecules>\";\r\n                    for (var i = 0; i < all.length ; i++){\r\n                        xml += \"<molecule>vidal://molecule/\" + all[i] + \"</molecule>\";\r\n                    }\r\n                    xml += \"</molecules>\";\r\n                }\r\n            }\r\n            \r\n            if (patient.cim10Ids && patient.cim10Ids.length > 0){\r\n                var all = patient.cim10Ids.split(\"|\");\r\n                if (patient.cim10Ids.length > 0){\r\n                    xml += \"<pathologies>\";\r\n                    for (var i = 0; i < all.length ; i++){\r\n                        xml += \"<pathology>vidal://cim10/\" + all[i] + \"</pathology>\";\r\n                    }\r\n                    xml += \"</pathologies>\";\r\n                }\r\n            }\r\n            \r\n            \r\n            return xml + \"</patient>\";\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    private getPrescriptionXml(prescription: any){\r\n        if (prescription){\r\n            var ret = \"<?xml version='1.0' encoding='UTF-8' standalone='yes'?><prescription>\";\r\n            var xmlLines = \"<prescription-lines>\";\r\n            if (prescription.lines){\r\n                for (var i=0 ; i < prescription.lines.length; i++){\r\n                    xmlLines += this.getPrescriptionLineXml(prescription.lines[i]);\r\n                }\r\n            }\r\n            xmlLines += \"</prescription-lines>\"\r\n            var xmlPatient = prescription.patient ? this.getPatientXml(prescription.patient) : \"\";\r\n            return ret + xmlPatient + xmlLines + \"</prescription>\";\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    getAlerts(callback: Function, prescription: any, params: any, type: string){\r\n        if (prescription && prescription.lines && prescription.lines.length > 0){\r\n            params.body = this.getPrescriptionXml(prescription);\r\n            this.toolbox.log(params.body);\r\n            params.url = this.getApiBaseUrl() + this.configuration.apiDomain + \r\n                (type == \"html\" ? this.configuration.alertsHtml : this.configuration.alertsFull) + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(null, data, error), \"POST\", params.url, params.body, this.contentType);\r\n        }\r\n    }\r\n\r\n    private getAlertColor(severity: string){\r\n        var color = {\"background\": \"red\", \"font\": \"\"};\r\n        switch(severity){\r\n            case \"LEVEL_1\":\r\n                color.background = \"yellow\";\r\n                color.font = \"black\";\r\n            break;\r\n            case \"LEVEL_2\":\r\n                color.background = \"orange\";\r\n                color.font = \"white\";\r\n            break;\r\n            case \"LEVEL_3\":\r\n                color.background = \"#FF4326\";\r\n                color.font = \"white\";\r\n            break;\r\n            case \"LEVEL_4\":\r\n                color.background = \"red\";\r\n                color.font = \"white\";\r\n            break;\r\n            case \"INFO\":\r\n                color.background = \"#b1b1b1\";\r\n                color.font = \"black\";\r\n            break;\r\n            default:\r\n            break;\r\n        }\r\n        return color;\r\n\r\n    }\r\n\r\n    private getRelevantAlerts(alert: any){\r\n        var als = [];\r\n        if (alert){\r\n            if (alert[\"vidal:maxAllergySeverity\"] && alert[\"vidal:maxAllergySeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxAllergySeverity\"].tag = \"ALL\";\r\n                alert[\"vidal:maxAllergySeverity\"].color = this.getAlertColor(alert[\"vidal:maxAllergySeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxAllergySeverity\"]);\r\n            }\r\n            if (alert[\"vidal:maxContraIndicationSeverity\"] && alert[\"vidal:maxContraIndicationSeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxContraIndicationSeverity\"].tag = \"CTI\";\r\n                alert[\"vidal:maxContraIndicationSeverity\"].color = this.getAlertColor(alert[\"vidal:maxContraIndicationSeverity\"][0].severity[0]);\r\n                als.push(alert.maxContraIndicationSeverity);\r\n            }\r\n            if (alert[\"vidal:maxDrugDrugInteractionsSeverity\"] && alert[\"vidal:maxDrugDrugInteractionsSeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxDrugDrugInteractionsSeverity\"].tag = \"INT\";\r\n                alert[\"vidal:maxDrugDrugInteractionsSeverity\"].color = this.getAlertColor(alert[\"vidal:maxDrugDrugInteractionsSeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxDrugDrugInteractionsSeverity\"]);\r\n            }\r\n            if (alert[\"vidal:maxPhysicoChemicalSeverity\"] && alert[\"vidal:maxPhysicoChemicalSeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxPhysicoChemicalSeverity\"].tag = \"PCI\";\r\n                alert[\"vidal:maxPhysicoChemicalSeverity\"].color = this.getAlertColor(alert[\"vidal:maxPhysicoChemicalSeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxPhysicoChemicalSeverity\"]);\r\n            }\r\n            if (alert[\"vidal:maxPosologySeverity\"] && alert[\"vidal:maxPosologySeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxPosologySeverity\"].tag = \"POS\";\r\n                alert[\"vidal:maxPosologySeverity\"].color = this.getAlertColor(alert[\"vidal:maxPosologySeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxPosologySeverity\"]);\r\n            }\r\n            if (alert[\"vidal:maxPrecautionSeverity\"] && alert[\"vidal:maxPrecautionSeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxPrecautionSeverity\"].tag = \"PRS\";\r\n                alert[\"vidal:maxPrecautionSeverity\"].color = this.getAlertColor(alert[\"vidal:maxPrecautionSeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxPrecautionSeverity\"]);\r\n            }\r\n            if (alert[\"vidal:maxProcreationSeverity\"] && alert[\"vidal:maxProcreationSeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxProcreationSeverity\"].tag = \"PRO\";\r\n                alert[\"vidal:maxProcreationSeverity\"].color = this.getAlertColor(alert[\"vidal:maxProcreationSeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxProcreationSeverity\"]);\r\n            }\r\n            if (alert[\"vidal:maxRedundantInteractionsSeverity\"] && alert[\"vidal:maxRedundantInteractionsSeverity\"][0].severity[0] != \"NO_ALERT\"){\r\n                alert[\"vidal:maxRedundantInteractionsSeverity\"].tag = \"RED\";\r\n                alert[\"vidal:maxRedundantInteractionsSeverity\"].color = this.getAlertColor(alert[\"vidal:maxRedundantInteractionsSeverity\"][0].severity[0]);\r\n                als.push(alert[\"vidal:maxRedundantInteractionsSeverity\"]);\r\n            }\r\n        }\r\n        return als;\r\n    }\r\n\r\n    assignAlertsToLines(prescription: any, xmlAlerts: any){\r\n        if (prescription && xmlAlerts && xmlAlerts.feed && xmlAlerts.feed.entry){\r\n            for (var i = 0; i < prescription.lines.length; i++){\r\n                var line = prescription.lines[i];\r\n                line.alertSummary = [];\r\n                for (var j = 0; j < xmlAlerts.feed.entry.length; j++){\r\n                    var alert = xmlAlerts.feed.entry[j];\r\n                    if (alert.id[0].startsWith(\"vidal://prescription_line\")){\r\n                        if (alert[\"vidal:drugId\"][0] == line.productId){\r\n                            line.alertSummary = this.getRelevantAlerts(alert);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    addStyleToHtml (text: string, hideSidebar: boolean, hideHeader: boolean){\r\n        if (text && this.getHtmlStyle()){\r\n            var style = \"<style>\";\r\n            style += \" \" + this.configuration.alertsHtmlStyle;\r\n            if (hideSidebar){\r\n                style += this.configuration.alertsHtmlStyleHideSidebar;\r\n            }\r\n            if (hideHeader){\r\n                style += \" \" + this.configuration.alertsHtmlStyleHideHeader;\r\n            }\r\n            style += \"</style>\";\r\n            return text.replace(\"<!-- custom-css -->\", style);\r\n        }\r\n        return text;\r\n    };    \r\n \r\n    getOptDocument(callback: Function, type: string, id: number){\r\n        if (type && id){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/documents/opt\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getDocuments(callback: Function, type: string, id: number, params: any){\r\n        if (type && id){\r\n            params.url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/documents\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", params.url, null, this.contentType);\r\n        }\r\n    }\r\n \r\n    getATCClassFromProduct(callback: Function, type: string, id: number){\r\n        if (type && id){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/atc-classification\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getVIDALClassFromProduct(callback: Function, type: string, id: number){\r\n        if (type && id){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/vidal-classification\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getProduct(callback: Function, type: string, id: number){\r\n        if (type && id){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    getVigieAlerts(callback: Function, prescription: any){\r\n        if (prescription && prescription.patient){\r\n            var arr = prescription.patient.dateOfBirth.split(\"-\");\r\n            var today = new Date();\r\n            var ageYears = today.getFullYear() - arr[0];\r\n            var prescs = [];\r\n            if (prescription.lines && prescription.lines.length > 0){\r\n                var atcs = [];\r\n                var vidals = [];\r\n                for (var i = 0; i < prescription.lines.length; i++){\r\n                    var presc = {\"atcs\": new Array(), \"vidalClasses\": new Array(), \"galenicForms\": new Array(), \"indications\": new Array(), \"routes\": new Array()};\r\n                    if (prescription.lines[i].atcClass){\r\n                        presc.atcs.push(prescription.lines[i].atcClass);\r\n                    }\r\n                    if (prescription.lines[i].vidalClass){\r\n                        presc.vidalClasses.push(prescription.lines[i].vidalClass);\r\n                    }\r\n                    if (prescription.lines[i].galenicFormId){\r\n                        presc.galenicForms.push(prescription.lines[i].galenicFormId);\r\n                    }\r\n                    if (prescription.lines[i].routeId){\r\n                        presc.routes.push(prescription.lines[i].routeId);\r\n                    }\r\n                    prescs.push(presc);\r\n                }\r\n            }\r\n            var body = {\"age\": ageYears, \"prescriptions\": prescs};\r\n            this.toolbox.log(JSON.stringify(body));\r\n            var url = this.configuration.urlVigie;// + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"POST\", url, JSON.stringify(body), \"application/json\");\r\n        }\r\n    }\r\n\r\n    getNewsFromProduct(callback: Function, type: string, id: number){\r\n        if (type && id && (type == \"product\" || type == \"package\")){\r\n            var url = this.getApiBaseUrl() + this.configuration.newsDomain + \"/\" + type + \"/\" + id + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }\r\n    }\r\n\r\n    private getPosologyXml(patient: any, routeIds: number[], indicationIds: number[]){\r\n        var routes = \"\";\r\n        var indications = \"\";\r\n\r\n        var xmlPatient = '<patient>' + this.getBasicPatientXml(patient) + '</patient>';\r\n\r\n        if (routeIds && routeIds.length > 0){\r\n            routes = '<routes>';\r\n            for (var i = 0; i < routeIds.length; i++){\r\n                routes += '<route>vidal://route/' + routeIds[i] + '</route>';\r\n            }\r\n            routes += '</routes>'\r\n        }\r\n\r\n        if (indicationIds && indicationIds.length > 0){\r\n            indications = '<indications>';\r\n            for (var i = 0; i < indicationIds.length; i++){\r\n                indications += '<indication>vidal://indication/' + indicationIds[i] + '</indication>';\r\n            }\r\n            indications += '</indications>'\r\n        }\r\n\r\n        return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><posology-request>' + xmlPatient + routes + indications + '</posology-request>';\r\n    }\r\n\r\n    getPosologyFromProduct(callback: Function, type: string, id: number, patient: any, routeIds: number[], indicationIds: number[], params: any){\r\n        if (type && id && patient){\r\n            params.url = this.getApiBaseUrl() + this.configuration.apiDomain + \"/\" + type + \"/\" + id + \"/posology-descriptors\" + this.getUrlCredentials(\"?\");\r\n            params.body = this.getPosologyXml(patient, routeIds, indicationIds);\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"POST\", params.url, params.body, this.contentType);\r\n        }\r\n    }\r\n\r\n    getUnitIdFromFrequency(stringFrequency: string){\r\n        var fil = this.frequencyToUnitId.filter((row) => row.key == stringFrequency);\r\n        return fil[0].value;\r\n    }\r\n\r\n    getFrequencyFromUnitId(unitId: Number){\r\n        if (unitId){\r\n            var fil = this.frequencyToUnitId.filter((row) => row.value == unitId);\r\n            return fil[0].key;\r\n        }else{\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    private getPostComplementXml(drugs: string[], icd10Codes: string[], text: string){\r\n        var ret = '<?xml version=\"1.0\" encoding=\"UTF-8\"?><request>';\r\n        if (drugs && drugs.length > 0){\r\n            ret += \"<drugs>\";\r\n            for (var i= 0; i< drugs.length; i++){\r\n                ret += \"<id>\" + drugs[i] + \"</id>\";\r\n            }\r\n            ret += \"</drugs>\";\r\n        }\r\n        if (icd10Codes && icd10Codes.length > 0){\r\n            ret += \"<codesToControl>\";\r\n            for (var i= 0; i< icd10Codes.length; i++){\r\n                ret += \"<codeToControl>\" + icd10Codes[i] + \"</codeToControl>\";\r\n            }\r\n            ret += \"</codesToControl>\";\r\n        }\r\n        if (text && text.length > 0){\r\n            ret += \"<text>\" + text + \"</text>\";\r\n        }\r\n        ret += \"<engine>VIDAL</engine><drugCursor>DEFAULT</drugCursor></request>\";\r\n        return ret;\r\n    }\r\n\r\n    getPostComplement(callback: Function, drugs: string[], icd10Codes: string[], text: string, params: any){\r\n        if ((drugs && drugs.length > 0) || (text && text.length > 0)){\r\n            params.url = this.getApiBaseUrl() + this.configuration.pmsiDomain + this.configuration.postComplement + this.getUrlCredentials(\"?\");\r\n            params.body = this.getPostComplementXml(drugs, icd10Codes, text);\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"POST\", params.url, params.body, this.contentType);\r\n        }\r\n    }\r\n\r\n    getCim10FromIndicationGroupId(callback: Function, id: number){\r\n         if (id){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.indicationGroup + \"/\" + id + \"/cim10s\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }          \r\n    }\r\n\r\n    getRecosFromIndicationGroupId(callback: Function, id: number){\r\n         if (id){\r\n            var url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.indicationGroup + \"/\" + id + \"/recos\" + this.getUrlCredentials(\"?\");\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"GET\", url, null, this.contentType);\r\n        }          \r\n    }\r\n\r\n    getPrescriptionRecos(callback: Function, prescription: any, params: any){\r\n        params.body = this.getPrescriptionXml(prescription);\r\n        params.url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.prescriptionRecos + this.getUrlCredentials(\"?\");\r\n        this.toolbox.log(prescription.xmlBody);\r\n        this.rest.call((data: any, error: any) => callback(data, error), \"POST\", params.url, params.body, this.contentType);\r\n    }\r\n\r\n    getRecoUrl(id: number){\r\n        return this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.reco + \"/\" + id + \"/html\" + this.getUrlCredentials(\"?\");\r\n    }\r\n\r\n    getReco(callback: Function, id: number){\r\n        this.rest.call((data: any, error: any) => callback(data, error), \"GET\", this.getRecoUrl(id), null, this.contentType);        \r\n    }\r\n\r\n    private getAdaptedDugsXml(vmpId: number, facets: any[], page: number, pageSize: number){\r\n        var ret = \"<adapted-drugs>\";\r\n        ret += \"<vmp-id>\" + vmpId + \"</vmp-id>\";\r\n        ret += \"<output-drug-type>PRODUCT</output-drug-type>\";\r\n        ret += \"<facets>\";\r\n        if (facets){\r\n            for (var i=0; i < facets.length; i++){\r\n                if (facets[i].active){\r\n                    ret += \"<facet name=\\\"\" + facets[i][\"vidal:facetName\"][0].name[0] + \"\\\" value=\\\"\" + facets[i][\"vidal:facetValue\"][0] + \"\\\"/>\";\r\n                }\r\n            }        \r\n        }\r\n        ret += \"</facets>\";\r\n        ret += \"<start-page>\" + page + \"</start-page>\";\r\n        ret += \"<page-size>\" + pageSize + \"</page-size>\";\r\n        ret += \"</adapted-drugs>\";\r\n        return ret;\r\n    }    \r\n    \r\n    getAdaptedDrugs(callback: Function, vmpId: number, facets: any[], page: number, pageSize: number, params: any){\r\n        if (vmpId){\r\n            params.body = this.getAdaptedDugsXml(vmpId, facets, page, pageSize);\r\n            params.url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.adaptedDrugs + this.getUrlCredentials(\"?\");\r\n            this.toolbox.log(params.xmlBody);\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"POST\", params.url, params.body, this.contentType);        \r\n        }\r\n    }\r\n\r\n\r\n    private getSideEffectsXml(drugs: string[], sideEffectId: number){\r\n        var ret = \"<?xml version='1.0' encoding='UTF-8' standalone='yes'?><adapted-drugs>\";\r\n        ret += \"<request>\";\r\n        ret += \"<ids>\";\r\n        if (drugs){\r\n            for (var i=0; i < drugs.length; i++){\r\n                    ret += \"<id>\" + drugs[i] + \"</id>\";\r\n            }        \r\n        }\r\n        ret += \"</ids>\";\r\n        ret += \"<sideEffectId>\" + sideEffectId + \"</sideEffectId>\";\r\n        ret += \"</request>\";\r\n        return ret;\r\n    }   \r\n\r\n    getSideEffects(callback: Function, drugs: string[], sideEffectId: number, params: any){\r\n        if (sideEffectId){\r\n            params.body = this.getSideEffectsXml(drugs, sideEffectId);\r\n            params.url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.sideEffectSort + this.getUrlCredentials(\"?\");\r\n            this.toolbox.log(params.xmlBody);\r\n            this.rest.call((data: any, error: any) => callback(data, error), \"POST\", params.url, params.body, this.contentType);        \r\n        }\r\n    }\r\n\r\n    getVigieHtml(data: any, title: string){\r\n        if (data.json && data.json.feed && data.json.feed.entry){\r\n            var html = \"\";\r\n            for (var i = 0; i < data.json.feed.entry.length; i++){\r\n                var entry = data.json.feed.entry[i];\r\n                //html += \"<h4>\" + entry.title + \"</h4>\";\r\n                html += entry.summary;\r\n            }\r\n            return \"<div class='notificationVigie'><h1>\" + title + \"</h1>\" + html + \"</div>\";\r\n        }        \r\n    }\r\n\r\n    getVersion(callback: Function, params: any, credentials: any = null){\r\n        params.url = this.getApiBaseUrl() + this.configuration.apiDomain + this.configuration.version + (credentials ? \"?\" + credentials : this.getUrlCredentials(\"?\"));\r\n        this.rest.call((data: any, error: any) => callback(data, error), \"GET\", params.url, null, this.contentType);        \r\n    }\r\n\r\n    flattenObject(object: any){\r\n        if (object.isArray()){\r\n            if (object.length == 1){\r\n                if (typeof object[0] == \"string\"){\r\n                    return object[0];\r\n                }else{\r\n                    if (object[0][\"_\"]){\r\n                        return object[0][\"_\"];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (object[\"_\"] == \"string\"){\r\n            return object[\"_\"];\r\n        }\r\n        return object;\r\n    }\r\n\r\n}"]}